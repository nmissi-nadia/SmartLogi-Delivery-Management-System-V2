databaseChangeLog:
  - changeSet:
      id: 4-create-user-enum-type
      author: nadia
      changes:
        - sql:
            splitStatements: false
            sql: |
              DO $$
              BEGIN
                IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'app_user_role_enum') THEN
                  CREATE TYPE app_user_role_enum AS ENUM ('CLIENT_EXPEDITEUR', 'DESTINATAIRE', 'LIVREUR', 'GESTIONNAIRE_LOGISTIQUE');
                END IF;
              END$$;
  - changeSet:
      id: 4-create-app-user-table
      author: nadia
      changes:
        - createTable:
            tableName: app_user
            columns:
              - column:
                  name: id
                  type: VARCHAR(36)
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: username
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: password
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: email
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: role
                  type: app_user_role_enum
                  constraints:
                    nullable: false
      rollback:
        - dropTable:
            tableName: app_user
        - sql:
            sql: DROP TYPE IF EXISTS app_user_role_enum;